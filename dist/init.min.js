export function init(t,e,i){const n=t.content.cloneNode(!0);if(e.template=n,e.transform){const t=n.firstElementChild;null!==t&&(e.leaf=t,process(e,0,0))}return i.appendChild(e.template),e}function inheritTemplate(t,e,i){return i?Object.assign(Object.assign({},t.transform),e):e}export function process(t,e,i){const n=t.leaf;if(void 0===n.matches)return;const o=t.transform;let s=null,r=!1,c=!1,l=!1;for(const a in o)if(n.matches(a)){const f=(0,o[a])({target:n,ctx:t,idx:e,level:i});if(void 0!==f)switch(typeof f){case"string":n.textContent=f;break;case"object":if(l=l||!!f.inheritMatches,void 0!==f.drill&&(s=null===s?f.drill:Object.assign(s,f.drill)),void 0!==f.matchFirstChild)switch(typeof f.matchFirstChild){case"boolean":"boolean"==typeof r&&f.matchFirstChild&&(r=!0);break;case"object":"object"==typeof r?Object.assign(r,f.matchFirstChild):r=f.matchFirstChild}if(void 0!==f.matchNextSib)switch(typeof f.matchNextSib){case"boolean":"boolean"==typeof c&&f.matchNextSib&&(c=!0);break;case"object":"object"==typeof c?Object.assign(c,f.matchNextSib):c=f.matchNextSib}}}if(c){let o=t.transform;"object"==typeof c&&(t.transform=inheritTemplate(t,c,l));const s=n.nextElementSibling;null!==s&&(t.leaf=s,process(t,e+1,i)),t.transform=o}if(r||null!==s){let e,o=t.transform;if(null!==s){const i=Object.keys(s);e=n.querySelector(i[0]),t.transform=inheritTemplate(t,s,l)}else e=n.firstElementChild,"object"==typeof r&&(t.transform=inheritTemplate(t,r,l));null!==e&&(t.leaf=e,process(t,0,i+1)),t.transform=o}}